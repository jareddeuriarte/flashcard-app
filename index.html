<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flashcards — Minimal</title>
  <style>
    /* =============================================================
       DESIGN (very minimal, dark, rectangular corners)!!!
       - Single deck only
       - Tap big card to flip
       - Next → and Shuffle buttons
       - Hamburger menu = Add/Edit/Delete + Import/Export + Reset
       - Avoid bright colors and rounded corners
       ============================================================= */
    :root{
      --bg:#0f0f10;
      --panel:#151516;
      --ink:#e8e8eb;
      --muted:#a8a8b0;
      --line:#272729;
      --danger:#ff6b6b;
      --radius:6px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial;}
    /* Top bar */
    header{position:sticky;top:0;z-index:10;background:var(--bg);border-bottom:1px solid var(--line)}
    .bar{display:flex;align-items:center;justify-content:space-between;padding:10px 12px}
    .title{font-weight:700;letter-spacing:.2px}
    .hamburger{width:42px;height:42px;border:1px solid var(--line);background:transparent;color:var(--ink);
      border-radius:var(--radius);display:flex;align-items:center;justify-content:center;cursor:pointer}
    /* Main */
    .app{max-width:720px;margin:0 auto;padding:16px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);
      min-height:40vh;display:flex;align-items:center;justify-content:center;text-align:center;
      padding:20px;line-height:1.35;font-size:20px;user-select:none}
    .card.empty{color:var(--muted)}
    .hint{margin-top:8px;color:var(--muted);font-size:13px}
    .controls{display:flex;gap:10px;margin-top:12px}
    button{appearance:none;border-radius:var(--radius);border:1px solid var(--line);
      background:#1a1a1b;color:var(--ink);padding:12px 14px;font-size:16px;cursor:pointer}
    button.primary{background:#202022}
    button:disabled{opacity:.5;cursor:not-allowed}
    .status{margin-top:10px;color:var(--muted);font-size:13px;display:flex;gap:12px}
    /* Drawer */
    .drawer{position:fixed;top:0;left:0;right:0;bottom:0;display:none}
    .drawer.open{display:block}
    .scrim{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.45)}
    .sheet{position:absolute;top:0;right:0;bottom:0;width:92vw;max-width:420px;background:var(--bg);
      border-left:1px solid var(--line);padding:14px;overflow:auto}
    .section{border:1px solid var(--line);border-radius:var(--radius);padding:12px;margin:10px 0;background:var(--panel)}
    .section h3{margin:0 0 10px 0;font-size:14px;letter-spacing:.2px}
    input, textarea{width:100%;padding:10px 12px;border-radius:var(--radius);border:1px solid var(--line);
      background:#121213;color:var(--ink);font-size:16px}
    textarea{min-height:80px;resize:vertical}
    label{font-size:13px;color:var(--muted)}
    .list{display:flex;flex-direction:column;gap:8px}
    .item{border:1px solid var(--line);background:#121213;border-radius:var(--radius);padding:10px}
    .row{display:flex;gap:8px;align-items:center}
    .row.right{justify-content:flex-end}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
    @media (hover:none){
      button, .hamburger{min-height:44px}
    }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="title">Flashcards — Minimal</div>
      <button id="hamburger" class="hamburger" aria-label="Open menu">☰</button>
    </div>
  </header>

  <main class="app">
    <!-- STUDY VIEW: one card only -->
    <div id="studyCard" class="card empty">No cards yet. Open the menu → Add Card.</div>
    <div class="hint">Tap the card to flip.</div>
    <div class="controls">
      <button id="nextBtn" class="primary" disabled>Next →</button>
      <button id="shuffleBtn">Shuffle</button>
    </div>
    <div class="status">
      <div id="progress">0 / 0</div>
      <div id="side">Front</div>
    </div>
  </main>

  <!-- Drawer menu -->
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div id="scrim" class="scrim" tabindex="-1"></div>
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="menuTitle">
      <h2 id="menuTitle" style="margin:4px 0 8px 0;font-size:16px">Menu</h2>

      <section class="section" aria-labelledby="addTitle">
        <h3 id="addTitle">Add Card</h3>
        <label for="frontInput">Front</label>
        <textarea id="frontInput" placeholder="e.g., hola"></textarea>
        <div style="height:8px"></div>
        <label for="backInput">Back</label>
        <textarea id="backInput" placeholder="e.g., hello (Spanish)"></textarea>
        <div class="row right" style="margin-top:8px">
          <button id="addCardBtn" class="primary">Save Card</button>
        </div>
      </section>

      <section class="section" aria-labelledby="manageTitle">
        <h3 id="manageTitle">Manage Cards</h3>
        <div id="cardsList" class="list"></div>
      </section>

      <section class="section" aria-labelledby="dataTitle">
        <h3 id="dataTitle">Data (optional)</h3>
        <div class="row" style="flex-wrap:wrap">
          <button id="exportBtn">Export JSON</button>
          <button id="importBtn">Import JSON</button>
          <input type="file" id="importFile" accept="application/json" class="sr-only" />
          <button id="resetBtn" style="margin-left:auto;color:var(--danger);border-color:#3a2323">Clear All</button>
        </div>
        <div class="hint" style="margin-top:8px">Export makes a backup. Import replaces your current set.</div>
      </section>

      <div class="row right">
        <button id="closeDrawer">Close</button>
      </div>
    </div>
  </aside>

  <script>
    /*********************************************************************
     * FLASHCARDS — MINIMAL SINGLE-DECK (LOCAL STORAGE ONLY)
     * -------------------------------------------------------------------
     * GOAL: Provide a tiny, easy-to-read implementation.
     * The comments explain each step so you can reverse‑engineer quickly.
     *
     * STORAGE MODEL:
     *   localStorage[STORAGE_KEY] = JSON.stringify({ cards: Card[] })
     *   Card = { id: string, front: string, back: string }
     *
     * RUNTIME STATE (not persisted):
     *   order: number[]   -> indices of cards in the current session order
     *   i: number         -> current position in 'order'
     *   flipped: boolean  -> whether the back is shown
     *********************************************************************/

    // ----------------------
    // 1) CONSTANTS & HELPERS
    // ----------------------

    // Key used to store/retrieve cards from localStorage
    var STORAGE_KEY = "flashcards_minimal_v1";

    // Convenience selector for one element
    function $(sel){ return document.querySelector(sel); }

    // Create a short unique id for new cards
    function uid(){
      return Math.random().toString(36).slice(2,10) + Date.now().toString(36).slice(-4);
    }

    // In-place Fisher–Yates shuffle
    function shuffleInPlace(arr){
      for(var j = arr.length - 1; j > 0; j--){
        var k = Math.floor(Math.random() * (j + 1));
        var tmp = arr[j]; arr[j] = arr[k]; arr[k] = tmp;
      }
      return arr;
    }

    // -------------
    // 2) DATA LAYER
    // -------------

    // Load from localStorage. If missing or invalid, seed with 2 demo cards.
    function loadState(){
      try{
        var raw = localStorage.getItem(STORAGE_KEY);
        if(raw){
          var parsed = JSON.parse(raw);
          if(parsed && Array.isArray(parsed.cards)) return parsed;
        }
      }catch(e){
        console.warn("Storage parse error", e);
      }
      var seed = {
        cards:[
          { id: uid(), front: "hola", back: "hello (Spanish)" },
          { id: uid(), front: "ser vs. estar", back: "Both = 'to be'\\nser = identity/essence\\nestar = state/condition" }
        ]
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(seed));
      return seed;
    }

    // Persist current cards and refresh dependent UI
    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      renderManageList();
      updateProgress();
      // If cards just appeared, initialize an order
      if(state.cards.length && order.length === 0){
        rebuildOrder();
        updateStudyCard();
      }
    }

    // Actual data in memory
    var state = loadState();

    // ------------------
    // 3) SESSION (RUNTIME)
    // ------------------
    var order = [];     // holds indices into state.cards
    var i = 0;          // pointer into 'order'
    var flipped = false;// whether back is showing

    function rebuildOrder(){
      // Recreate a simple linear order 0..n-1
      order = [];
      for(var idx=0; idx<state.cards.length; idx++){ order.push(idx); }
      i = 0;
      flipped = false;
      updateProgress();
    }

    function shuffleOrder(){
      shuffleInPlace(order);
      i = 0;
      flipped = false;
      updateStudyCard();
      updateProgress();
    }

    function nextCard(){
      if(!state.cards.length) return;
      i = (i + 1) % order.length;
      flipped = false;
      updateStudyCard();
      updateProgress();
    }

    function flipCard(){
      if(!state.cards.length) return;
      flipped = !flipped;
      updateStudyCard();
      // progress text unchanged on flip
    }

    // -------------------
    // 4) RENDERING (STUDY)
    // -------------------
    var cardEl = $("#studyCard");
    var nextBtn = $("#nextBtn");
    var shuffleBtn = $("#shuffleBtn");
    var progressEl = $("#progress");
    var sideEl = $("#side");

    function updateStudyCard(){
      if(state.cards.length === 0){
        // Show empty state
        cardEl.classList.add("empty");
        cardEl.style.whiteSpace = "normal";
        cardEl.textContent = "No cards yet. Open the menu → Add Card.";
        nextBtn.disabled = true;
        sideEl.textContent = "Front";
        return;
      }
      // Show current card
      var idx = order[i];
      var card = state.cards[idx];
      cardEl.classList.remove("empty");
      cardEl.style.whiteSpace = flipped ? "pre-wrap" : "normal";
      cardEl.textContent = flipped ? card.back : card.front;
      sideEl.textContent = flipped ? "Back" : "Front";
      nextBtn.disabled = false;
    }

    function updateProgress(){
      var total = state.cards.length;
      if(total === 0){ progressEl.textContent = "0 / 0"; return; }
      // i is 0-based; display 1-based for humans
      var pos = (i + 1);
      progressEl.textContent = pos + " / " + order.length;
    }

    // ---------------------
    // 5) DRAWER (HAMBURGER)
    // ---------------------
    var drawer = $("#drawer");
    var hamburger = $("#hamburger");
    var scrim = $("#scrim");
    var closeDrawerBtn = $("#closeDrawer");

    function openDrawer(){
      drawer.classList.add("open");
      drawer.setAttribute("aria-hidden", "false");
    }
    function closeDrawer(){
      drawer.classList.remove("open");
      drawer.setAttribute("aria-hidden", "true");
    }

    hamburger.addEventListener("click", openDrawer);
    closeDrawerBtn.addEventListener("click", closeDrawer);
    scrim.addEventListener("click", closeDrawer);

    // --------------------
    // 6) ADD / MANAGE CARDS
    // --------------------
    var frontInput = $("#frontInput");
    var backInput = $("#backInput");
    var addCardBtn = $("#addCardBtn");
    var cardsList = $("#cardsList");

    addCardBtn.addEventListener("click", function(){
      var front = (frontInput.value || "").trim();
      var back  = (backInput.value  || "").trim();
      if(!front || !back){ alert("Please fill both Front and Back."); return; }

      state.cards.push({ id: uid(), front: front, back: back });
      saveState();        // persist + refresh list + progress

      // clear inputs
      frontInput.value = "";
      backInput.value = "";

      // if first card, build session; else add its index to the end of the order
      if(state.cards.length === 1){
        rebuildOrder();
      }else{
        order.push(state.cards.length - 1);
      }
      updateStudyCard();
    });

    function renderManageList(){
      cardsList.innerHTML = "";
      if(state.cards.length === 0){
        var empty = document.createElement("div");
        empty.className = "hint";
        empty.textContent = "No cards yet — add one above.";
        cardsList.appendChild(empty);
        return;
      }
      state.cards.forEach(function(c, idx){
        var item = document.createElement("div");
        item.className = "item";

        var top = document.createElement("div");
        top.className = "row";
        top.style.justifyContent = "space-between";

        var text = document.createElement("div");
        text.style.fontWeight = "600";
        text.textContent = c.front;

        var actions = document.createElement("div");
        actions.className = "row";

        var editBtn = document.createElement("button");
        editBtn.textContent = "Edit";
        editBtn.addEventListener("click", function(){ editCard(idx); });

        var delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.style.borderColor = "#3a2323";
        delBtn.style.color = "var(--danger)";
        delBtn.addEventListener("click", function(){ deleteCard(idx); });

        actions.appendChild(editBtn);
        actions.appendChild(delBtn);
        top.appendChild(text);
        top.appendChild(actions);

        var back = document.createElement("div");
        back.style.whiteSpace = "pre-wrap";
        back.style.color = "var(--muted)";
        back.style.marginTop = "6px";
        back.textContent = c.back;

        item.appendChild(top);
        item.appendChild(back);
        cardsList.appendChild(item);
      });
    }

    function editCard(idx){
      var card = state.cards[idx];
      var newFront = prompt("Edit Front", card.front);
      if(newFront === null) return;
      var newBack  = prompt("Edit Back", card.back);
      if(newBack === null) return;

      card.front = newFront.trim();
      card.back  = newBack.trim();
      saveState();
      updateStudyCard();
    }

    function deleteCard(idx){
      if(!confirm("Delete this card?")) return;
      state.cards.splice(idx, 1);
      saveState();
      rebuildOrder();
      updateStudyCard();
    }

    // -------------------
    // 7) IMPORT / EXPORT / RESET
    // -------------------
    var exportBtn = $("#exportBtn");
    var importBtn = $("#importBtn");
    var importFile = $("#importFile");
    var resetBtn = $("#resetBtn");

    if(exportBtn){
      exportBtn.addEventListener("click", function(){
        var data = JSON.stringify(state, null, 2);
        var blob = new Blob([data], {type:"application/json"});
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url; a.download = "flashcards.json"; a.click();
        URL.revokeObjectURL(url);
      });
    }

    if(importBtn){
      importBtn.addEventListener("click", function(){ importFile.click(); });
    }

    if(importFile){
      importFile.addEventListener("change", function(e){
        var file = (e.target.files && e.target.files.length) ? e.target.files[0] : null;
        if(!file) return;
        var reader = new FileReader();
        reader.onload = function(){
          try{
            var data = JSON.parse(reader.result);
            if(!data || !Array.isArray(data.cards)) throw new Error("Invalid file");
            // normalize cards
            state = { cards: data.cards.map(function(c){
              return { id: c.id || uid(), front: String(c.front || ""), back: String(c.back || "") };
            }) };
            saveState();
            rebuildOrder();
            updateStudyCard();
            alert("Import complete.");
          }catch(err){
            alert("Import failed: " + err.message);
          }
        };
        reader.readAsText(file);
        importFile.value = "";
      });
    }

    if(resetBtn){
      resetBtn.addEventListener("click", function(){
        if(!confirm("This will remove all cards. Continue?")) return;
        localStorage.removeItem(STORAGE_KEY);
        state = loadState();
        saveState();
        rebuildOrder();
        updateStudyCard();
      });
    }

    // -----------------------
    // 8) WIRE STUDY CONTROLS
    // -----------------------
    cardEl.addEventListener("click", flipCard);
    nextBtn.addEventListener("click", nextCard);
    shuffleBtn.addEventListener("click", shuffleOrder);

    document.addEventListener("keydown", function(e){
      // Flip on Space/Enter; Next on ArrowRight; Shuffle on S
      if(e.key === " " || e.key === "Enter"){ e.preventDefault(); flipCard(); }
      else if(e.key === "ArrowRight"){ nextCard(); }
      else if(e.key === "s" || e.key === "S"){ shuffleOrder(); }
      else if(e.key === "Escape"){ closeDrawer(); }
    });

    // -----------------------
    // 9) INITIALIZE APP
    // -----------------------
    (function init(){
      if(state.cards.length){
        rebuildOrder();
        updateStudyCard();
        nextBtn.disabled = false;
      } else {
        nextBtn.disabled = true;
      }
      renderManageList();
    })();
  </script>
</body>
</html>
